---
file-created: 星期三, 十一月 ,2023
last-modified: 星期日, 十一月 ,2023
---

我们希望我们的程序可以在不同的平台运行，这将为我们带来更多的用户。那么我们该如何让我们的代码支持跨平台呢？

## 错误示范
这样的坏处在于，每一次执行操作前，都需要判断当前系统，这样不仅会影响运行效率，而且也会增加代码的复杂度，特别是因为部分操作可能有不同的变量名/参数，出现在其他系统无法编译的情况都是非常有可能的。

这样是否会影响性能其实也是一个大的问题,如果将 CurrentOS定义为`const` 或许编译器可以识别出来部分指令是肯定不会执行的也说不定. 

TOVERIFY : 是否影响性能 

```go
if CurrentOS == "windos"{
    // do something only can be done in windos
}else if CurrentOS == "linux"{
    // do something only can be done in linux
}else{
    // other os
}

```

## 正确示范
利用[[conditional compilation]]
### go
go语言提供的方法是，给文件名加上后缀，声明其在何种系统下才会编译。
上面的函数可以被分为三个文件。xxx_windos.go xxx_linux.go

这里其实也是有问题,就是你在win的环境下,你是无法识别linux中的错误,你需要在不同的平台写代码? 
肯定是可以设置的 不用担心. 
TODO 

### C/C++
相比较之下C的条件编译比go的要方便，或者说限制更少，不限制在某个文件中。
通过检查已定义的宏，我们可以判断当前系统

任何函数都可以按照下面的格式来写,这样就可以实现不同的版本的兼容了.

```c
#ifdef _WIN32
std::cout << "Windows\n";
#elif __linux__
std::cout << "Linux\n";
#elif __APPLE__
std::cout << "Apple\n";
#endif
```

```c
int main(){
	#ifdef __WIN32__
	printf("win32 environment init \n");
	#endif

	#ifdef __linux__
	printf("linux environment init \n");
	#endif
	printf("Your application implement\n");
	return 0;
}
```

或者如果你想添加一些实验性的功能, 你也可以利用条件编译. 
TODO

